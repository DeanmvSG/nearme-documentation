---
partial: false
---

{% assign xhr = params['is_xhr'] == 'true' %}

{% unless xhr %}
<div class="wrapper-a search-list">
  <div class="search-box">
    <form class="search-form" action="/search" method="GET" data-search-form="filters" data-search-form-container>
      <input type="text" name="query" placeholder="Enter keywords to search for items" data-search-form="query" autofocus="autofocus" value="{{ params['query'] }}" />
      <button class="button button-default" data-search-form="submit">SEARCH</button>
    </form>
  </div>

  <aside class="search-sidebar">
    <button data-toggle-search-filters class="button button-default search-sidebar__filter-search-button">Filter search</button>
    <h4>Filter by:</h4>
    <form class="form-horizontal no-inheritance" data-search-form="filters">
      <ul>
        {% assign attributes = searcher.filterable_custom_attributes | reverse %}
        {% for ca in attributes %}
        <li {{ ca.wrapper_html_options }}>
          <fieldset>
            <legend>{{ ca.label }}</legend>
            <select {{ ca.input_html_options }} class="form-control custom-select" name="lg_custom_attributes[{{ ca.name }}][]" id="">
              <option value="">Please select</option>
              {% for opt in ca.valid_values %}
                <option value="{{ opt }}" {% if params['lg_custom_attributes']['item_type'][0] == opt %}selected{% endif %}>{{ opt }}</option>
              {% endfor %}
            </select>
          </fieldset>
        </li>
        {% endfor %}
        <li>
          <fieldset>
            <legend>Location</legend>
            <input type="text" name="item_location_city" id="item_location_city" placeholder="City" />
          </fieldset>
        </li>
        <li>
          <fieldset>
            <legend>Availability</legend>
            <ul>
              <li>
                <label class="availability-filter datetimepicker">
                  <i class="fa fa-calendar"></i>
                  From:
                  <input type="text" name="availability_exceptions[from]-datetimepicker" class="form-control" data-availability-filter="from" />
                  <input type="hidden" name="availability_exceptions[from]" />
                </label>
              </li>
              <li>
                <label class="availability-filter datetimepicker">
                  <i class="fa fa-calendar"></i>
                  To:
                  <input type="text" name="availability_exceptions[to]-datetimepicker" class="form-control" data-availability-filter="to" />
                  <input type="hidden" name="availability_exceptions[to]" />
                </label>
              </li>
            </ul>
          </fieldset>
        </li>
        <li>
          <fieldset>
            <legend>Price</legend>
            <input type="hidden" name="price[min]" value="0" data-price-min-input />
            <select class="form-control custom-select" name="price[max]" id="price" data-price-select>
              <option value="">Please select</option>
              <option value="50">Under $50</option>
              <option value="100">Under $100</option>
              <option value="200">Under $200</option>
              <option value="300">Under $300</option>
              <option value="400">Under $400</option>
              <option value="500">Under $500</option>
              <option value="1000000" data-price-min="500">$500+</option>
            </select>
          </fieldset>
        </li>
      </ul>
    </form>
  </aside>
{% endunless %}

  <main class="search-results" data-search-form="results">
    {% if searcher.results.size == 0 %}
      <p class="empty-resultset">
        There are no results to show.
      </p>
    {% else %}
      <div class="search-results__summary">
        <div class="results-number">
          <p>{{ searcher.result_count }} Results</p>
        </div>

        <div class="results-sorting">
          <form class="form-inline" data-search-form="filters">
            <label for="sort_by">
              Sort by:
              <select class="form-control" name="sort" id="sort_by">
                <option value="name_asc" {% if searcher.sort == 'name_asc' %}selected{% endif %}>Item name ascending</option>
                <option value="name_desc" {% if searcher.sort == 'name_desc' %}selected{% endif %}>Item name descending</option>
                <option value="all_prices_asc" {% if searcher.sort == 'all_prices_asc' %}selected{% endif %}>Price ascending</option>
                <option value="all_prices_desc" {% if searcher.sort == 'all_prices_desc' %}selected{% endif %}>Price descending</option>
                <option value="created_at_desc" {% if searcher.sort == 'created_at_desc' or searcher.sort == 'relevance' %}selected{% endif %}>Date entered</option>
                <option value="popularity" {% if searcher.sort == 'popularity' %}selected{% endif %}>Popularity</option>
              </select>
            </label>
          </form>
        </div>
      </div>

      <section class="search-results__items">
        {% for listing in searcher.results %}
          <article data-listing>
            <a href="{{ listing.show_path }}" class="listing-link">
              <figure>
                <img src="{{ listing.photos[0].large }}" />
                <figcaption>
                  {% assign price_option = listing | lowest_price_without_cents_with_currency %}
                  <dl class="rent-price">
                    <dt>Rent</dt>
                    <dd>{{ price_option.price }}</dd>
                  </dl>

                  <dl class="retail-bond-value">
                    <dt>Bond</dt>
                    <dd>{{ listing.properties.bond_value | price_without_cents_with_currency }}</dd>
                    {% if listing.properties.retail_value != blank %}
                    <dt>Retail</dt>
                    <dd>{{ listing.properties.retail_value | price_without_cents_with_currency }}</dd>
                    {% endif %}
                  </dl>


                  {% if listing.properties.designer_name != blank %}
                    <span class="designer">{{ listing.properties.designer_name }}</span>
                  {% endif %}
                </figcaption>
              </figure>
            </a>

            <div data-add-favorite-button="true" data-path="{{ listing.wish_list_path }}" data-wishlistable-type="{{ listing.class_name }}" data-link-to-classes="" data-path-bulk="{{ listing.wish_list_bulk_path }}" data-object-id="{{ listing.id }}" id="favorite-button-{{ listing.class_name }}-{{ listing.id }}"></div>

            <a href="{{ listing.creator.user_profile_url }}" class="lender-link">
              <img src="{{ listing.creator.avatar_url_thumb }}" alt="{% if listing.creator.properties.use_alias_as_name == '1' %}{{ listing.creator.properties.user_alias }}{% else %}{{ listing.creator.name }}{% endif %}">
            </a>
          </article>
        {% endfor %}
      </section>
    {% endif %}
  </main>
{% unless xhr %}
</div>
{% endunless %}
