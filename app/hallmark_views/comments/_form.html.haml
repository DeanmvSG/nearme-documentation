- comment_view ||= false

- data = { user_entry_form: '', user_entry_form_remote: '' }
- if comment.commentable.persisted?
  - data['new-comment-for'] = comment.commentable.id

- if comment.persisted?
  - data['user_entry_edit_mode'] = ''

- if comment.persisted?
  - data['user_entry_form_target'] = "#entry-content-comment-#{comment.id}"
- else
  - data['user_entry_form_target'] = "#comments-feed-#{comment.commentable.id}"

= simple_form_for comment, url: url_to_comment(comment.commentable, comment), html: { multipart: true, data: data, class: 'user-entry-form' }  do |f|
  - if comment_view
    %input{:type => "hidden", name: "comment_view", value: 1 }/

  .user-entry-form-content
    - image = current_user.try(:avatar).try(:url, :thumb)
    %figure= image_tag(image || space_listing_placeholder_path(width: 30, height: 30))


    - textareaData = { user_entry_form_content: '' }
    - textareaData['user_entry_form_submit_on_return'] = '' unless comment.persisted?
    = f.input :body, input_html: { maxlength: 5000, data: textareaData, cols: 40, rows: 1 }

    - unless comment.persisted?
      .submit-hint Press ENTER to submit

    - # When implementing multiple images, new image form should be moved outside of the images area, thumbs in their own container
    = f.simple_fields_for :activity_feed_images, collection_or_new_object(f.object.activity_feed_images) do |afi|

      .image-upload-input
        = afi.input :image, wrapper: false, label: false do
          = afi.file_field :image, data: { user_entry_form_file: '' }, accept: 'image/*', capture: 'camera'

      .user-entry-form-images{ data: { user_entry_form_images: '' } }
        - if afi.object.image.present?
          .user-entry-form-image{ data: { user_entry_form_image: '' } }
            %img{ src: afi.object.image.url(:space_listing), data: { user_entry_form_thumbnail: '' } }
            = afi.input :_destroy, as: :hidden, input_html: { data: { user_entry_form_remove_input: '' }, value: '' }

  %p.action
    - if comment.persisted?
      %button.button-a.tiny.light{ type: 'button', data: { cancel_edit: '' }} Cancel
    = f.submit I18n.t('activity_feed.user_status_submit'), class: 'button-a tiny'

