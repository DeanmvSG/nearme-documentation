- legacy false

- title @location.name

- content_for :hero do
  .container-fluid
    %h1
      #{@location.name}

      - if @location.url.present?
        = link_to @location.url, :target => :_blank do
          %div.ico-link

  = render 'photos'

%article#space

  .clearfix
    .row-fluid.padding-row
      .span4
        %h2 Overview
        %p= truncate_with_ellipsis @location.description, 250

        - if @location.phone.present?
          %strong.ico-phone.padding= @location.phone

        - if @location.creator
          %h2 Company
          %p
        - if @location.creator.phone
          %p.ico-phone.padding= @location.creator.phone
        %p= truncate_with_ellipsis @location.company.description, 250

      - if @amenities
        %h2 Amenities
        %ul
          - @location.amenities.each do |amenity|
            %li= amenity

      .span8
        = render :partial => 'bookings', :locals => { :selected_listing => @listing }

- content_for :script do
  :javascript
    // Initialize the ui controller
    $(function() {
      new Space.Controller(
        $('article.space, article#space'),
        {
          bookings: {
            listings: #{raw location_listings_json},
            review_url: #{raw review_location_reservations_url(@location).to_json},

            // Have we returned from setting up a session. If there are bookings, the JS controller
            // will trigger showing the booking confirmation modal.
            returnedFromSession: #{@initial_bookings.present? ? 'true' : 'false'},

            // FIXME: We should move the 'Today' default booking behaviour to this seed data.
            initial_bookings: #{@initial_bookings.to_json}
          }
        });
      });
    analytics.track("Viewed a Location", {
      suburb: "#{@location.suburb}",
      city: "#{@location.city}",
      state: "#{@location.state}",
      country: "#{@location.country}",
    });
