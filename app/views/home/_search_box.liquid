{% assign search_box_class = 'span10 offset1' %}
{% assign search_input_class = 'span9' %}

{% if platform_context.multiple_transactable_types? == true %}
    {% assign search_input_class = 'span7' %}
{% endif %}

{% assign button_wrapper_class = 'span3' %}

{% if platform_context.date_pickers? == true and platform_context.multiple_transactable_types? == true %}
    {% assign search_box_class = 'span12' %}
    {% assign search_input_class = 'span4' %}
    {% assign button_wrapper_class = 'span2' %}
{% endif %}

{% if platform_context.date_pickers? == true and platform_context.multiple_transactable_types? == false %}
    {% assign search_box_class = 'span10 offset1' %}
    {% assign search_input_class = 'span5' %}
    {% assign button_wrapper_class = 'span3' %}
{% endif %}

{% if platform_context.date_pickers? == true and platform_context.multiple_transactable_types? == true and platform_context.tt_select_type == 'radio'%}
    {% assign search_box_class = 'span10 offset1' %}
    {% assign search_input_class = 'span5' %}
    {% assign button_wrapper_class = 'span3' %}
{% endif %}

{% if platform_context.date_pickers? == false and platform_context.multiple_transactable_types? == true and platform_context.tt_select_type == 'radio'%}
    {% assign search_box_class = 'span10 offset1' %}
    {% assign search_input_class = 'span9' %}
    {% assign button_wrapper_class = 'span3' %}
{% endif %}

<div class="{{ search_box_class }}" id="search_row">
  <div class="row-fluid">
    <h1>
      {{ platform_context.tagline }}
    </h1>
  </div>
  <div class="black-box row-fluid">
    <form action="/search" class="home_search" id="listing_search" method="get">
      <div class="input-wrapper">
        {% if platform_context.bookable? %}
          <div class="geolocation no-bookings">
            <span class="ico-crosshairs"></span>
          </div>
        {% endif %}
          <div class="row-fluid">
            <div class="{{ search_input_class }}">
                <input class="query" id="search" name="loc" placeholder="{{ platform_context.search_field_placeholder }}" type="text"></input>
                {% if platform_context.bookable? == true and platform_context.buyable? == true%}
                    <input class="query" id="search_prod" name="query" placeholder="{{ platform_context.search_field_placeholder }}" type="text" style="display: none;"></input>
                {% endif %}

                {% if platform_context.multiple_transactable_types? == true %}
                    {% if platform_context.tt_select_type == 'radio' %}
                        {% for transactable_type in platform_context.all_transactables  %}
                            {{ transactable_type.name}} <input type="radio" name="transactable_type_id" value="{{ transactable_type.id }}" {% if forloop.first == true %} checked {% endif %} data-buyable="{{transactable_type.buyable?}}">
                        {% endfor %}
                    {% endif %}
                {% endif %}
            </div>

          {% if platform_context.multiple_transactable_types? == true and platform_context.tt_select_type == 'dropdown' %}
              <div class="span2">
                  <select class="no-icon select2" name="transactable_type_id">
                      {% for transactable_type in platform_context.all_transactables %}
                        <option value="{{ transactable_type.id }}" data-buyable="{{transactable_type.buyable?}}">{{ transactable_type.name }}</option>
                      {% endfor %}
                  </select>
              </div>
          {% endif %}

          {% if platform_context.date_pickers? == true %}
              <div class="span2">
                  <input id='start_date' class='search_date' type="text" name='start_date' readonly="readonly" value="From"/>
                  <input id='availability_dates_start' type="hidden" name="availability[dates][start]"/>
              </div>

              <div class="span2">
                  <input id='end_date' class='search_date' type="text" name='end_date' readonly="readonly" value="To"/>
                  <input id='availability_dates_end' type="hidden" name="availability[dates][end]"/>
              </div>
          {% endif %}

           <div class="{{ button_wrapper_class }}">
              <a class="btn btn-green btn-large search-button" data-disable-with="{{ 'homepage.disabled_buttons.search' | translate }}" rel="submit" href="">
                  <span class="ico-search"></span>
                  {{ 'homepage.buttons.search' | translate }}
              </a>
              <div id="suggest_location" style="display: none"></div>
           </div>
          </div>
      </div>

      <input name="buyable" id="is_buyable" value="{{platform_context.buyable?}}" type="hidden"></input>

    </form>
    {% if platform_context.bookable? %}
      <input id="lat" name="lat" type="hidden" value>
      <input id="lng" name="lng" type="hidden" value>
      <input id="nx" name="nx" type="hidden" value>
      <input id="ny" name="ny" type="hidden" value>
      <input id="sx" name="sx" type="hidden" value>
      <input id="sy" name="sy" type="hidden" value>
      <input id="country" name="country" type="hidden" value>
      <input id="state" name="state" type="hidden" value>
      <input id="city" name="city" type="hidden" value>
      <input id="suburb" name="suburb" type="hidden" value>
      <input id="street" name="street" type="hidden" value>
      <input id="postcode" name="postcode" type="hidden" value>
    {% endif %}
  </div>
</div>

{% if platform_context.searcher_type != 'fulltext' and platform_context.bookable? %}
  {% content_for domready %}
    new Search.HomeController($('#listing_search'))
  {% endcontent_for %}
{% endif %}
