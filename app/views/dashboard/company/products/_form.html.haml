= simple_form_for @product_form, wrapper: :bs3, url: @product_form.product.slug.present? ? dashboard_company_product_type_product_path(@product_type, @product_form.product) : dashboard_company_product_type_products_path(@product_type, @product_form.product), html: {id: "product_form", multipart: true,  method: @product_form.product.slug.present? ? :put : :post } do |f|
  = f.simple_fields_for :extra_properties, f.object.extra_properties do |properties_form|
    - @form_components.each do |form_component|
      - data_hash ||= nil
      - if form_component.form_fields.include?({ 'product' => 'shipping_info' })
        - data_hash = { 'js-element-identifier' => 'initial_shipping_profiles_section' }
      %section.list{ data: data_hash }
        - form_component.form_fields.each do |form_field|
          - model = form_field.keys.first
          - field = form_field[model]
          - if model == 'product'
            = render 'forms/product_form', f: f, properties_form: properties_form, only_inputs: [ field.to_sym ], form_fields: form_component.form_fields

  .submit-bar
    = link_to dashboard_company_product_type_products_path(@product_type) do
      .btn.gray= t('cancel')
    = f.submit "Save item", class: "btn medium blue"

- content_for :domready do
  new Dashboard.AddressController($("#product_form"));
  var boarding_form = new BoardingForm($("#product_form"));
  new ShippoFieldsManager(#{raw DimensionsTemplate::UNITS_OF_MEASURE.to_json});
  new CategoriesController($('#product_form'));
