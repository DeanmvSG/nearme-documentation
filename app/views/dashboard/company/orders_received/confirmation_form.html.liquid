<header class="dialog__header">
  <h2 id="dialog__title">Approve Request 2</h2>
</header>

{% assign form_url = 'confirm_dashboard_company_orders_received_path' | generate_url: order.id, listing_id: order.transactable.id %}

{% form_for order, as: 'order', form_for_type: 'dashboard', url: @form_url, html-data-modal: true, method: post, html-data-form-name: 'order-approval' %}
  <div class="dialog__body">
    <div class="row">
      <div class="col-xs-12">

        {% if params.shipping_provider_name == blank %}

        <h3>Please select shipping provider</h3>
        <ul>
          <li>
            <a class="button" data-modal="true" href="{{ 'confirmation_form_dashboard_company_orders_received_path' | generate_url: order.id, listing_id: order.transactable, shipping_provider_name: 'sendle' }}">Sendle</a>
            <button type="button" class="hint-toggler" data-toggle="tooltip" title="" data-original-title="Sendle delivers parcels door-to-door across Australia at flat rates cheaper than post. You can read more at https://www.sendle.com/" />
          </li>
          <li><a class="button" data-modal="true" href="{{ 'confirmation_form_dashboard_company_orders_received_path' | generate_url: order.id, listing_id: order.transactable, shipping_provider_name: 'manual' }}">Manual shipping</a>
            <button type="button" class="hint-toggler" data-toggle="tooltip" title="" data-original-title="???" />
</li>
          <li><a class="button" data-modal="true" href="{{ 'confirmation_form_dashboard_company_orders_received_path' | generate_url: order.id, listing_id: order.transactable, shipping_provider_name: 'manual', shipping_provider_fee: 1000 }}">Australian Post [manual] $10</a>
            <button type="button" class="hint-toggler" data-toggle="tooltip" title="" data-original-title="???" />
          </li>
        </ul>

        <hr>
        {% else %}

        <h3>Item Rental Summary</h3>

        <dl class="clearfix">
          <dt> Selected Shipping Provider:</dt>
          <dd> {{ params['shipping_provider_name']}} </dd>

          <dt>Item:</dt>
          <dd>
            {% if order.transactable != blank %}
              <a href="{{ order.transactable.show_path }}">
                {{ order.transactable.name }}
              </a>
            {% endif %}
          </dd>

          <dt>Shipping Package:</dt>
          <dd>{{ order.shipping_package.label }}</dd>

          {% assign requested_dates = order.long_dates %}
          {% assign requested_dates_size = requested_dates.size %}

          <dt>Period:</dt>
          <dd>{{ order.transactable_pricing.number_of_units }} days</dd>

          <dt>Rental date:</dt>
          <dd>{{ order.starts_at | to_date | l: 'short' }}</dd>

          <dt>Return date:</dt>
          <dd>{{ order.starts_at | to_date | add_to_date: order.transactable_pricing.number_of_units | l: 'short'  }} </dd>
        </dl>

        <dl class="clearfix">
          <dt>Borrower:</dt>
          <dd>{{ order.owner.name }}</dd>

          <dt>Borrower ship to address:</dt>
          <dd>{{ order.enquirer_shipping_address.discreet }}</dd>
        </dl>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12">
        <div class="row">
          <div class="col-xs-12 col-md-6">
            {% input inbound_sender_firstname, label: 'Lender first name', required: true %}
          </div>
          <div class="col-xs-12 col-md-6">
            {% input outbound_receiver_firstname, as: hidden, label: 'Receiver first name', required: true %}
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12 col-md-6">
            {% input inbound_sender_lastname, label: 'Lender Last name', required: true %}
          </div>
          <div class="col-xs-12 col-md-6">
            {% input outbound_receiver_lastname, as: hidden, label: 'Receiver Last name', required: true %}
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12 col-md-6">
            {% input inbound_pickup_date, label: 'Pick Up Date', wrapper_html-class: 'datetimepicker', input_html-data-datetimepicker: "true", required: true %}
          </div>
          <div class="col-xs-12 col-md-6">
            {% input outbound_pickup_date, label: 'Shipping Return Date', wrapper_html-class: 'datetimepicker', input_html-data-datetimepicker: "true", required: true %}
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12 col-md-6">
            <div>
              {% input inbound_pickup_address_address, label: "Address Line" %}
              {% input inbound_sender_phone, label: "Phone" %}
              {% input inbound_pickup_address_suburb, label: "Suburb" %}
              {% input inbound_pickup_address_state, label: "State" %}
              {% input inbound_pickup_address_postcode, label: "Postcode" %}
              {% input inbound_pickup_address_country, as: hidden, value: 'Australia', label: "Country" %}
            </div>
          </div>
          <div class="col-xs-12 col-md-6">
            <div>
              {% input outbound_return_address_address, label: "Address Line" %}
              {% input outbound_receiver_phone, label: "Phone" %}
              {% input outbound_return_address_suburb, label: "Suburb" %}
              {% input outbound_return_address_state, label: "State" %}
              {% input outbound_return_address_postcode, label: "Postcode" %}
              {% input outbound_return_address_country, as: hidden, value: 'Australia', label: "Country" %}
            </div>
          </div>
        </div>

        <hr/>

        <h4>Total Cost</h4>

        <dl class="item-pricing">
          <dt>Item Rental ({{ order.transactable_pricing.number_of_units }} days)</dt>
          <dd>{{ order.transactable_pricing.price | price_with_cents_with_currency }}</dd>
          <dt>Service Fee</dt>
          <dd>{{ order.service_fee_amount_host | price_with_cents_with_currency }}</dd>
          <dt>Approx. Shipping Cost</dt>
          <dd>{{ order.shipping_line_items.last.unit_price | price_with_cents_with_currency }}</dd>
          <dt>You will earn (Approx)</dt>
          <dd><strong>{{ order.total_payable_to_host_minus_second_shipping | price_with_cents_with_currency }}</strong></dd>


        </dl>

        {% endif %}
      </div>
    </div>
  </div>

  <div class="dialog__actions">

    {% if params.shipping_provider_name != blank %}
      {% submit Approve, class: 'button button-default' %}
    {% endif %}
    <a href="#" class="button button-inverse" data-modal-close>Cancel</a>
  </div>
{% endform_for%}
