- title t('dashboard.nav.transfers')

.dash-page
  .dash-head.clearfix
    %p= t('dashboard.nav.transfers')
  .dash-body
    - if @last_week_payment_transfers.empty?
      %p.no_data.text-center No transfers have been made in the preceding 7 day period.
    - else
      .chart
        .total.right
          - @chart.totals_by_currency.each do |currency, sum|
            .total-number.left
              = "#{currency_content_tag(currency, sum, :span, { :rel => false })}".html_safe
          %span{class: 'total-text'} 7 day total
        %canvas#chart

    - unless @company.any_payout_option_available?
      %p.warning.text-center
        %i.ico-warning
        You haven't set a payment method yet.
        = link_to "Set one up now.", edit_dashboard_company_payouts_path
    - if @payment_transfers.present?
      .table-responsive
        %table.table.table-simple
          %thead
            %tr
              %th Gross
              %th Fees
              %th Total
              %th Transferred
          %tbody
            - @payment_transfers.each do |payment_transfer|
              %tr
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.gross_amount, :span)
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.service_fee_amount_guest, :span)
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.amount, :span)
                %td
                  = payment_transfer.created_at.strftime('%Y-%m-%d')

      = will_paginate_styled @payment_transfers

- content_for :domready do
  new ChartWrapper.Line($('#chart'), #{@chart.values.to_json.html_safe}, #{@chart.labels.to_json.html_safe})
