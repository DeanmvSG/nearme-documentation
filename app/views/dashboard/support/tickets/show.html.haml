- title t('reservations.rfq_long')
- @ticket = @ticket.decorate
- @date_presenter = DatePresenter.new(@ticket.reservation_dates)
- if @ticket.reservation_details['start_minute'].present? && @ticket.reservation_details['end_minute'].present?
  - @hourly_presenter = HourlyPresenter.new(@ticket.reservation_dates.first, @ticket.reservation_details['start_minute'].to_i, @ticket.reservation_details['end_minute'].to_i)

.dash-page
  .dash-head.clearfix
    - if @ticket.target.action_free_booking?
      %p="#{t('reservations.rfq_short')} ##{@ticket.id}: "
    - else
      %p="#{t('reservations.offer')} ##{@ticket.id}: "
    %p
      Quantity: #{@ticket.reservation_details['quantity']}
    %p.pull-right
      Status:
      %span{class: "#{@ticket.state}"}= @ticket.state.titleize

  - span_class2 = 'span10'
  - span_class3 = 'span2'
  -# hack with false - we need it for NuclearLink, which does not use dates
  - if @ticket.reservation_dates.any? && false
    - span_class1 = 'span3'
    - span_class2 = 'span3'
    - span_class3 = 'span1 offset1'
  .dash-body.thread

    = render partial: 'ticket_message', collection: @ticket.messages, spacer_template: 'spacer'

    - if @ticket.open?
      = render partial: 'form', locals: { ticket: @ticket, message: @message, with_close: true, form_url: dashboard_support_ticket_ticket_messages_path(@ticket, @message) }

= content_for :script do
  :javascript
    jQuery.timeago.settings.strings.minutes = "%d min"
    jQuery.timeago.settings.strings.minute = jQuery.timeago.settings.strings.minutes
    jQuery.timeago.settings.strings.seconds = jQuery.timeago.settings.strings.minutes;
    jQuery.timeago.settings.strings.hours = "about %d h"
    jQuery.timeago.settings.strings.hours = jQuery.timeago.settings.strings.hours
    $('abbr.timeago').timeago();

    $('#toggle-more-reservations').click(function(e){
      e.preventDefault()
      $('#more-reservations').hide();
      $('#toggle-more-reservations').hide()
    });

    $('#toggle-less-reservations').click(function(e){
      e.preventDefault()
      $('#more-reservations').show();
      $('#toggle-more-reservations').show()
    });
    new Support.TicketMessageController($('.message-form').eq(0))
