.nav-wrapper{:role => "navigation"}
  .brand
    = image_tag "instance_admin/brand-logo.png", :class => "brand-logo"

  %ul.sidebar.nav.nav-stacked

    - if @authorizer.authorized?('Analytics')
      %li#analytics
        %a{"data-parent" => "#analytics", "data-toggle" => "collapse", :href => "#analytics-sub"}
          %i.fa.fa-bar-chart-o
          %span Analytics
        %ul#analytics-sub.sub-nav.collapse{:class => ("in" if controller.class.to_s.split("::").first(2).join("::") == "InstanceAdmin::Analytics")}
          - InstanceAdmin::BaseController::ANALYTICS_CONTROLLERS.each do |controller_name, settings|
            %li
              %a{href: "#{url_for controller: settings.fetch(:controller, "/instance_admin/analytics/" + controller_name), action: settings[:default_action]}", :class => ("active" if controller.controller_name == (settings[:controller] || controller_name).split('/').last)}
                %span= "#{controller_name.titleize}"


    - if @authorizer.authorized?('Settings')
      %li#settings
        %a{"data-parent" => "#settings", "data-toggle" => "collapse", :href => "#settings-sub"}
          %i.fa.fa-gears
          %span Settings
        %ul#settings-sub.sub-nav.collapse{:class => ("in" if controller.class.to_s.split("::").first(2).join("::") == "InstanceAdmin::Settings")}
          - InstanceAdmin::BaseController::SETTINGS_CONTROLLERS.each do |controller_name, settings|
            %li
              %a{href: "#{url_for controller: settings.fetch(:controller, "/instance_admin/settings/" + controller_name), action: settings[:default_action]}", :class => ("active" if controller.controller_name == (settings[:controller] || controller_name).split('/').last)}
                %span= "#{controller_name.titleize}"


    - if @authorizer.authorized?('Theme')
      %li#theme
        %a{"data-parent" => "#theme", "data-toggle" => "collapse", :href => "#theme-sub"}
          %i.fa.fa-picture-o
          %span Theme
        %ul#theme-sub.sub-nav.collapse{:class => ("in" if controller.class.to_s.split("::").first(2).join("::") == "InstanceAdmin::Theme")}
          - InstanceAdmin::BaseController::THEME_CONTROLLERS.each do |controller_name, settings|
            %li
              %a{href: "#{url_for controller: settings.fetch(:controller, "/instance_admin/theme/" + controller_name), action: settings[:default_action]}", :class => ("active" if controller.controller_name == (settings[:controller] || controller_name).split('/').last)}
                %span= "#{controller_name.titleize}"


    - if @authorizer.authorized?('Manage')
      %li#manage
        %a{"data-parent" => "#manage", "data-toggle" => "collapse", :href => "#manage-sub"}
          %i.fa.fa-briefcase
          %span Manage
        %ul#manage-sub.sub-nav.collapse{:class => ("in" if controller.class.to_s.split("::").first(2).join("::") == "InstanceAdmin::Manage")}
          - InstanceAdmin::BaseController::MANAGE_CONTROLLERS.each do |controller_name, settings|
            %li
              %a{href: "#{url_for controller: settings.fetch(:controller, "/instance_admin/manage/" + controller_name), action: settings[:default_action]}", :class => ("active" if controller.controller_name == (settings[:controller] || controller_name).split('/').last)}
                %span= "#{controller_name.titleize}"


    - if @authorizer.authorized?('Blog')
      %li#blog
        %a{"data-parent" => "#blog", "data-toggle" => "collapse", :href => "#blog-sub"}
          %i.fa.fa-pencil
          %span Blog
        %ul#blog-sub.sub-nav.collapse{:class => ("in" if controller.class.to_s.split("::").first(2).join("::") == "InstanceAdmin::ManageBlog")}
          - InstanceAdmin::BaseController::MANAGE_BLOG_CONTROLLERS.each do |controller_name, settings|
            %li
              %a{href: "#{url_for controller: settings.fetch(:controller, "/instance_admin/manage_blog/" + controller_name), action: settings[:default_action]}", :class => ("active" if controller.controller_name == (settings[:controller] || controller_name).split('/').last)}
                %span= "#{controller_name.titleize}"
