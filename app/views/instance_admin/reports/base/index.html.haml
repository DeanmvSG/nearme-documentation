.content-container
  %h4= t('instance_admin.reports.generated.title')
  .row
    .table-container.col-xs-12
      %table.table
        %thead
          %tr
            %th= t('instance_admin.reports.generated.type')
            %th= t('instance_admin.reports.generated.creator')
            %th= t('instance_admin.reports.generated.status')
            %th= t('instance_admin.reports.generated.date_time')
            %th= t('instance_admin.reports.generated.actions')

        %tbody
          - @generated_reports.each do |report|
            %tr
              %td
                = report.report_type
              %td
                = report.creator.name
              %td
                = report.state
              %td
                = report.created_at
              %td
                - if report.created?
                  = link_to t('instance_admin.reports.generated.available_actions.download'), report.zip_file.url, class: 'btn btn-blue btn-small'
                - elsif report.ready_to_create?
                  = t('instance_admin.reports.generated.available_actions.wait_for_report_creation')
                - else
                  = t('instance_admin.reports.generated.available_actions.no_actions')

.row
  .text-container
    .pull-right
      = will_paginate @generated_reports, param_name: :generated_page

.content-container.reports
  .row
    .text-container
      = form_tag [:instance_admin, :reports, @scope_class], method: :get, enforce_utf8: :false do
        .filters
          = filter_dropdown param_name: :item_type_id, label: t("instance_admin.manage.admin_searchable.base.search_types.#{@scope_type_class.name.tableize}"), allow_blank: true, blank_label: t("instance_admin.reports.all_#{@scope_type_class.name.tableize}"), all_values: @scope_type_class.all.each_with_object({}) { |val, obj| obj[val.id.to_s] = val.translated_bookable_noun }

          = filter_searchable_dates param_name: 'date', label: t('instance_admin.manage.admin_searchable.transactable.search_types.created_at')

          = filter_query_text label: t('instance_admin.manage.admin_searchable.transactable.search_types.search_by'), placeholder: t('instance_admin.manage.admin_searchable.search_by_keyword'), param_name: 'q'

          = filter_dropdown param_name: :per_page, label: t('instance_admin.manage.admin_searchable.per_page'), allow_blank: false, all_values: {'25' => '25', '50' => '50', '100' => '100' }

          .filter.download-export
            = link_to t('instance_admin.reports.request_report_generation'), '', data: { 'download-report' => 1, 'report-url' => polymorphic_path([:request_report_generation, :instance_admin, :reports, @scope_class]) }

  .row
    .table-container.col-xs-12
      %table.table
        %tr
          %th
            = t('instance_admin.reports.fields.id')
          %th
            = t('instance_admin.reports.fields.name')
          - if @scope_class == Transactable
            %th
              = t('instance_admin.reports.fields.creator_name')
            %th
              = t('instance_admin.reports.fields.creator_email')
            %th
              = t('instance_admin.reports.fields.description')
            %th
              = t('instance_admin.reports.fields.actions')
          - else
            %th
              = t('instance_admin.reports.fields.email')
            %th
              = t('instance_admin.reports.fields.properties')
        - @resources.each do |transactable|
          = render 'transactable', :transactable => transactable


.row
  .text-container
    .pull-right
      = will_paginate @resources

