= simple_form_for [:instance_admin, :manage, @workflow_step, resource], :html => { :multipart => true, id: 'workflow_form'} do |f|
  .content-container
    %h4 Main settings
    .row
      .input-container.col-xs-12
        = f.input :name, required: true, input_html: { class: 'form-control' }
    .row
      .input-container.col-xs-6
        = f.input :recipient, input_html: { class: 'form-control' }
      .input-container.col-xs-6
        = f.input :recipient_type, collection: WorkflowAlert::RECIPIENT_TYPES, include_blank: true, input_html: { class: 'form-control' }
    .row
      .input-container.col-xs-6
        = f.input :alert_type, collection: WorkflowAlert::ALERT_TYPES, include_blank: false, input_html: { class: 'form-control', :'data-alert-type' => true }
      .input-container.col-xs-6
        = f.input :delay, label: 'Delay (minutes)', input_html: { class: 'form-control' }
    %div{:'data-optional-settings-email' => true, :'data-optional-settings' => true}
      %h4 Email Settings
      .row
        .input-container.col-xs-6
          = f.input :template_path, collection: @custom_emails, disabled: true, required: true, input_html: { class: 'form-control' }, hint: "You can add custom emails in Manage -> Emails"
        .input-container.col-xs-6
          = f.input :layout_path, collection: @custom_email_layouts, disabled: true, required: true, input_html: { class: 'form-control' }, hint: "You can add custom layout in Manage -> Email Layouts"
      .row
        .input-container.col-xs-6
          = f.input :cc, disabled: true, required: true, input_html: { class: 'form-control' }
        .input-container.col-xs-6
          = f.input :bcc, disabled: true, required: true, input_html: { class: 'form-control' }
      .row
        .input-container.col-xs-6
          = f.input :from, disabled: true, required: true, input_html: { class: 'form-control' }
        .input-container.col-xs-6
          = f.input :from_type, collection: WorkflowAlert::RECIPIENT_TYPES, disabled: true, include_blank: true, input_html: { class: 'form-control' }
      .row
        .input-container.col-xs-6
          = f.input :reply_to, disabled: true, input_html: { class: 'form-control' }
        .input-container.col-xs-6
          = f.input :reply_to_type, collection: WorkflowAlert::RECIPIENT_TYPES, disabled: true, include_blank: true, input_html: { class: 'form-control' }
      .row
        .input-container.col-xs-12
          = f.input :subject, placeholder: 'Hello {{user.first_name}}, provide subject', disabled: true, required: true, input_html: { class: 'form-control' }, hint: "Provide liquid string"
      - if defined? @workflow_step.associated_class.constantize::CUSTOM_OPTIONS
        = f.simple_fields_for :custom_options, OpenStruct.new(f.object.custom_options) do |custom_option_form|
          - @workflow_step.associated_class.constantize::CUSTOM_OPTIONS.each do |custom_option|
            .row
              .input-container.col-xs-12
                = custom_option_form.input custom_option

    %div{:'data-optional-settings-sms' => true, :'data-optional-settings' => true}
      %h4 Sms Settings
      .row
        .input-container.col-xs-6
          = f.input :template_path, collection: @custom_smses, disabled: true, required: true, input_html: { class: 'form-control' }, hint: "You can add custom sms template in Manage -> Smses"

  %br
  = f.button :submit, 'Save', class: 'btn btn-green pull-right'

= content_for :script do
  :javascript
    new InstanceAdmin.WorkflowFormController($('#workflow_form'));
