%article.listing{:'data-id' => listing.id, :'data-name' => listing.name, :'data-latitude' => listing.latitude, :'data-longitude' => listing.longitude}
  .row-fluid
    .span4.nested.photo-container
      = link_to listing do
        - if listing.photos.first
          = image_tag listing.photos.first.url(:space_listing), :title => listing.name, :alt => listing.name
        - else
          = image_tag google_maps_streetview_url(:height => 254, :width => 410, :latitude => listing.latitude, :longitude => listing.longitude), :title => listing.name, :alt => listing.name
    .span8.nested.details-container
      %h2
        = link_to "#{listing.name}", listing
      %h4.hidden-iphone.location-hours
        %span.ico-marker
          %strong
            = listing.location.name
          = pretty_availability_sentence(listing.availability)
      %p.hidden-phone.listing-description
        = listing.description
      %aside.prices
        = render :partial => 'search/shared/price_information', :locals => { :listing => listing }
      .bottom-fade
- # We may want to move this, but I've put it here for simplicities sake and as an example for now.
:javascript
  $(function() {
    new HeightConstrainer(
      $('article.listing[data-id=#{listing.id}] .details-container'),
      $('article.listing[data-id=#{listing.id}] .photo-container'),
      {
        ratio: 254/410
      }
    )
  })
