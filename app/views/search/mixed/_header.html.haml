%header#listing_search.container-fluid.mixed{class: platform_context.instance.default_search_view.present? ? 'with-toggle' : ''}
  .header-inner
    %form.search_results{:action => search_path(v: result_view), :method => "get"}
      = hidden_field_tag :transactable_type_id, @transactable_type.id
      = hidden_field_tag :lntype, @searcher.search.lntype
      = hidden_field_tag :lgtype, @searcher.search.lgtype
      = hidden_field_tag :lgpricing, @searcher.search.lgpricing
      = hidden_field_tag :lgattribute, @searcher.search.lgattribute
      = hidden_field_tag :start_date, @searcher.search.display_dates[:start]
      = hidden_field_tag :end_date, @searcher.search.display_dates[:end]
      = hidden_field_tag 'availability[dates][start]', @searcher.search.start_date
      = hidden_field_tag 'availability[dates][end]', @searcher.search.end_date
      .row-fluid
        .span12
          - if platform_context.instance.default_search_view.present?
            .list-map-toggle.span2
              %a.map{ href: search_path(params.merge(v: platform_context.map_view)), class: active_class(result_view, platform_context.map_view), title: 'Map' }
                Map
              %a.list{ href: search_path(params.merge(v: 'list')), class: active_class(result_view, 'list'), title: 'List' }
                List
          .search-container.span7
            .geolocation-input{ :class => (platform_context.fulltext_geo_search? ? 'span5' : 'span10')}
              .geolocation
                %span.ico-crosshairs
              %input#search{:name => "loc", :placeholder => platform_context.search_field_placeholder, :type => "text", :value => @searcher.query, :class => "query", :autocomplete => "off", 'data-disable-autocomplete' => platform_context.fulltext_search?}
            -if platform_context.fulltext_geo_search?
              .keyword-input.span5
                .search-loop-icon
                  %span.ico-search
                %input#search{:name => "query", :placeholder => platform_context.search_by_keyword_placeholder, :type => "text", :value => @searcher.keyword, :class => "query"}
            .search-icon.btn.btn-green.span2
              %span.ico-search

      - search_geofields.each do |geofield|
        = hidden_field_tag geofield, params.fetch(geofield, '')
      = hidden_field_tag :sort, @searcher.search.sort
      = hidden_field_tag :v, result_view
      = hidden_field_tag :ignore_search_event, 0
      = hidden_field_tag :page, 1
      = hidden_field_tag :per_page, per_page
