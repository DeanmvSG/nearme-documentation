- if f.object.offer.document_requirements.present?
  %section.checkout-form.documents
    %h2 Required Documents
    - f.object.offer.document_requirements.each_with_index do |doc, index|
      = f.simple_fields_for :payment_documents, f.object.payment_documents[index] || f.object.payment_documents.new(user: current_user, attachable: f.object, payment_document_info_attributes: { attachment_id: f.object.id, document_requirement_id: doc.id}) do |document|
        .row-fluid
          .span3
            %label
              - if @offer.upload_obligation.try(:required?)
                %abbr{ title: "required" } *
              = doc.label
          .span9.upload{ 'data-upload' => true }
            %button{ type: 'button', class: 'btn-upload-payment-document', 'data-upload-document' => true }
              = t 'buy_sell_market.checkout.labels.choose_file'
            - if document.object.file.present?
              %span{ "data-file-name" => true }
                = document.object.file.file_name
            - else
              %span{ "data-file-name" => true }
                = t 'buy_sell_market.checkout.labels.no_file_chosen'

            %ul
              - document.object.errors[:file].each do |error|
                %li.flash.error
                  = error

            = document.input :file, as: :file, label: false, input_html: { class: 'hidden-field', "data-document-#{index}" => true }
            = document.input :file_cache, as: :hidden
            = document.input :user_id, as: :hidden

            = document.simple_fields_for :payment_document_info, document.object.payment_document_info do |pdi|
              = pdi.input :attachment_id, as: :hidden
              = pdi.input :document_requirement_id, as: :hidden
