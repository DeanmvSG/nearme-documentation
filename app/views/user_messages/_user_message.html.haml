- thread_context = user_message.thread_context
- author = user_message.author_with_deleted
.row-fluid
  .span12.listing-message{class: user_message.css_class(current_user) }
    .span3
      %p.name
        - if author.deleted?
          = "#{author.first_name} (Deleted)"
        - else
          = link_to author.first_name, profile_path(author.slug)
      %p.date= distance_of_time_in_words_or_date_in_time_zone(user_message.created_at, current_user.time_zone)

    .span7
      %p.body
        = link_to truncate(user_message.body, length: 60), user_message.show_path, title: user_message.body
      %p.link-to-listing
        = user_messages_decorator.user_message_context_link(user_message)


    .span2.actions
      - if user_message.unread_for?(current_user)
        = link_to "Read", user_message.show_path, class: 'btn btn-green'
      - elsif !user_message.archived_for?(current_user)
        = link_to "Archive", user_message.archive_path, class: "btn btn-gray", method: :put
