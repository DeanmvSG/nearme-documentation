- error = f.object.errors[category.name.to_sym]
= content_tag :div, class: error.present?  ? 'error' : '' do
  -if category.present?
    - if category.autocomplete?
      = f.input :category_ids, as: :array, wrapper: :bootstrap, label: category.translated_name, :placeholder => "Enter a category", input_html: { "data-category-autocomplete" => true, "data-category-id" => category.id, "data-selected-catgories" => f.object.common_categories(category).map(&:id).join(','), value: []}, required: category.mandatory?

    - else
      = content_tag :div, id: "category_#{category.id}_tree_content" do
        = hidden_field_tag "single_choice_category", category.multiple_root_categories == true, class: 'single_choice_category'
        .control-group
          = f.label :categories, class: 'control-label' do
            - if category.mandatory?
              %abbr{title: 'required'} *
            = category.translated_name
          .controls
            #ajax_error{style: 'display: none;'}
            .category_tree
            .category_tree_inputs
            - if error.present?
              .help-inline= error.first