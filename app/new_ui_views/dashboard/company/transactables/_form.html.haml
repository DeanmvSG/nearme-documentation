- custom_attribute_names = @transactable_type.custom_attributes.collect { |custom_attribute| custom_attribute.name }
= f.hidden_field :transactable_type_id, value: @transactable_type.id
= f.hidden_field :booking_type, value: @transactable.transactable_type.booking_choices.size == 1 ? f.object.transactable_type.booking_choices.first : @transactable.booking_type, 'data-booking-type' => true
= f.input :id, as: :hidden

= f.simple_fields_for :properties, f.object.properties do |properties_form|

  - @form_components.each_with_index do |form_component, index|
    - component_class = 'listing-form-component panel-tab-container'
    - component_class = "#{component_class} active" if index == 0
    %div{class: component_class, indexid: "form-component-#{form_component.id}"}

      - form_component.form_fields.each do |form_field|

        - model = form_field.keys.first
        - field = form_field[model]

        - next if field == 'schedule'
        - next if field == 'enabled'

        - case field

        - when 'location_id'
          = render "dashboard/company/transactables/form_fields/location", f: f

        - when 'rental_shipping_type'
          = render "dashboard/company/transactables/form_fields/rental_shipping_type", f: f

        - when 'approval_requests'
          = render 'dashboard/shared/fields/approval_requests', f: f

        - when 'amenity_types'
          = render "dashboard/company/transactables/form_fields/amenity_types", f: f

        - when 'action_rfq'
          = render "dashboard/company/transactables/form_fields/action_rfq", f: f

        - when 'price'
          = render "dashboard/company/transactables/form_fields/price", f: f, form_fields: form_component.form_fields, model: model

        - when 'additional_charges'
          = render "dashboard/company/transactables/form_fields/additional_charges", f: f

        - when 'photos'
          = render "dashboard/company/transactables/form_fields/photos", f: f

        - when 'waiver_agreement_templates'
          = render "dashboard/company/transactables/form_fields/waiver_agreement_templates", f: f

        - when 'seller_attachments'
          = render "dashboard/company/transactables/form_fields/seller_attachments", f: f

        - when 'documents_upload'
          = render "dashboard/company/transactables/form_fields/documents_upload", f: f

        - when 'quantity'
          = render "dashboard/company/transactables/form_fields/quantity", f: f

        - when 'currency'
          = render "dashboard/company/transactables/form_fields/currency", f: f

        - when 'confirm_reservations'
          = render "dashboard/company/transactables/form_fields/confirm_reservations", f: f

        - when *@transactable_type.categories.roots.map { |c| "Category - #{c.name}" }
          = render "dashboard/company/transactables/form_fields/category", f: f, field: field

        - else
          - if custom_attribute_names.include?(field)
            = draw_attribute_for_form(@transactable_type.custom_attributes.find_by(name: field), properties_form)
          -elsif f.object.attributes.include?(field)
            - if enable_ckeditor_for_field?(model, field)
              = f.input field, :as => :ckeditor, :input_html => { :ckeditor => { :toolbar => ckeditor_toolbar_creator.toolbar } }
            - else
              = f.input field
.hidden
  - Money::Currency.table.values.each do |c|
    %span{:id => "currency_#{c[:iso_code]}"}
      = c[:symbol]
  %span{:id => "default_currency"}= @transactable_type.default_currency

